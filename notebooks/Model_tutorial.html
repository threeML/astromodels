<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model tutorial &mdash; Astromodels latest documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="../_static/dark_mode_css/dark.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../_static/dark_mode_js/default_dark.js"></script>
        <script src="../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Priors for Bayesian analysis" href="Priors_for_Bayesian_analysis.html" />
    <link rel="prev" title="Multi-component sources" href="Multi_component_sources.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Astromodels
            <img src="../_static/transp_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Quick_start.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="function_list.html">Available Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Functions_tutorial.html">Functions tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Point_source_tutorial.html">Point sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="Extended_sources_tutorial.html">Extended source tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="Multi_component_sources.html">Multi-component sources</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Define-sources">Define sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-a-model">Create a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Getting-information-about-a-model">Getting information about a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Accessing-and-modifying-sources-and-parameters-from-the-model-instance">Accessing and modifying sources and parameters from the model instance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Fully-qualified-paths">Fully-qualified paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Using-shortcuts">Using shortcuts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Saving-a-model-to-file">Saving a model to file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Load-a-model-from-a-file">Load a model from a file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Linking-parameters">Linking parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Advanced-use-of-linking:-arbitrary-functions">Advanced use of linking: arbitrary functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Time-varying-models-and-other-independent-variables">Time-varying models and other independent variables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Priors_for_Bayesian_analysis.html">Priors for Bayesian analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="Additional_features_for_scripts_and_applications.html">Additional features for scripts and applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html#astromodels">astromodels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/API.html#astromodels-package">astromodels package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Astromodels</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Model tutorial</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Model-tutorial">
<h1>Model tutorial<a class="headerlink" href="#Model-tutorial" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>In this tutorial we show how to build a simple model with two point sources, how to save it for later use, and re-load it back. We will also plot the spectra of the two point sources, with their components.</p>
<p>See the documents about creating and getting information about functions, point sources and extended sources for details about these operations. Here we only focus on the global model.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="kn">from</span> <span class="nn">astromodels</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># We also import astropy units to show the unit-conversion</span>
<span class="c1"># feature</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
</pre></div>
</div>
</div>
<section id="Define-sources">
<h2>Define sources<a class="headerlink" href="#Define-sources" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Now let‚Äôs define a point source (see ‚ÄúCreating point sources‚Äù for details and alternative way to accomplish this):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s start by defining a simple point source with a power law spectrum</span>
<span class="n">powerlaw</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">()</span>

<span class="n">pts1</span> <span class="o">=</span> <span class="n">PointSource</span><span class="p">(</span><span class="s1">&#39;source_1&#39;</span><span class="p">,</span> <span class="n">ra</span><span class="o">=</span><span class="mf">125.6</span><span class="p">,</span> <span class="n">dec</span><span class="o">=-</span><span class="mf">75.3</span><span class="p">,</span>
                   <span class="n">spectral_shape</span><span class="o">=</span><span class="n">powerlaw</span><span class="p">)</span>

<span class="c1"># Get some info about what we just created</span>
<span class="n">pts1</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>

<span class="c1"># Have a quicker look</span>
<span class="n">pts1</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ul>

<li>source_1 (point source):
<ul>

<li>position:
<ul>

<li>ra:
<ul>

<li>value: 125.6</li>

<li>desc: Right Ascension</li>

<li>min_value: 0.0</li>

<li>max_value: 360.0</li>

<li>unit: deg</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>dec:
<ul>

<li>value: -75.3</li>

<li>desc: Declination</li>

<li>min_value: -90.0</li>

<li>max_value: 90.0</li>

<li>unit: deg</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>equinox: J2000</li>

</ul>

</li>

<li>spectrum:
<ul>

<li>main:
<ul>

<li>Powerlaw:
<ul>

<li>K:
<ul>

<li>value: 1.0</li>

<li>desc: Normalization (differential flux at the pivot value)</li>

<li>min_value: 1e-30</li>

<li>max_value: 1000.0</li>

<li>unit: keV-1 s-1 cm-2</li>

<li>is_normalization: True</li>

</ul>

</li>

<li>piv:
<ul>

<li>value: 1.0</li>

<li>desc: Pivot value</li>

<li>min_value: None</li>

<li>max_value: None</li>

<li>unit: keV</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>index:
<ul>

<li>value: -2.01</li>

<li>desc: Photon index</li>

<li>min_value: -10.0</li>

<li>max_value: 10.0</li>

<li>unit: </li>

<li>is_normalization: False</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #af5fd7; text-decoration-color: #af5fd7; font-weight: bold">source_1</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚î£‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf; font-weight: bold">üî≠ position</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚î£‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf">ra</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚îó‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf">dec</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f; font-weight: bold">üåà spectrum</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">main</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚î£‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">Powerlaw</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">K</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">piv</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îÉ   ‚îó‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">index</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îó‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">polarization</span>
</pre></div>
</div>
<p>Now let‚Äôs define another source, this time at Galactic Coordinates l = 11.25, b = -22.5, and with two spectral components:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Another point source with two spectral components</span>

<span class="n">spectrum1</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">index</span><span class="o">=-</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">component1</span> <span class="o">=</span> <span class="n">SpectralComponent</span><span class="p">(</span><span class="s1">&#39;synchrotron&#39;</span><span class="p">,</span><span class="n">spectrum1</span><span class="p">)</span>

<span class="n">spectrum2</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">index</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">component2</span> <span class="o">=</span> <span class="n">SpectralComponent</span><span class="p">(</span><span class="s1">&#39;IC&#39;</span><span class="p">,</span><span class="n">spectrum2</span><span class="p">)</span>

<span class="n">point_source2</span> <span class="o">=</span> <span class="n">PointSource</span><span class="p">(</span><span class="s1">&#39;source_2&#39;</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mf">11.25</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mf">22.5</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="n">component1</span><span class="p">,</span><span class="n">component2</span><span class="p">])</span>

<span class="c1"># Have a look at what we just created</span>

<span class="n">point_source2</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ul>

<li>source_2 (point source):
<ul>

<li>position:
<ul>

<li>l:
<ul>

<li>value: 11.25</li>

<li>desc: Galactic longitude</li>

<li>min_value: 0.0</li>

<li>max_value: 360.0</li>

<li>unit: deg</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>b:
<ul>

<li>value: -22.5</li>

<li>desc: Galactic latitude</li>

<li>min_value: -90.0</li>

<li>max_value: 90.0</li>

<li>unit: deg</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>equinox: J2000</li>

</ul>

</li>

<li>spectrum:
<ul>

<li>synchrotron:
<ul>

<li>Powerlaw:
<ul>

<li>K:
<ul>

<li>value: 0.20000000000000004</li>

<li>desc: Normalization (differential flux at the pivot value)</li>

<li>min_value: 1e-30</li>

<li>max_value: 1000.0</li>

<li>unit: keV-1 s-1 cm-2</li>

<li>is_normalization: True</li>

</ul>

</li>

<li>piv:
<ul>

<li>value: 1.0</li>

<li>desc: Pivot value</li>

<li>min_value: None</li>

<li>max_value: None</li>

<li>unit: keV</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>index:
<ul>

<li>value: -0.75</li>

<li>desc: Photon index</li>

<li>min_value: -10.0</li>

<li>max_value: 10.0</li>

<li>unit: </li>

<li>is_normalization: False</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

<li>IC:
<ul>

<li>Powerlaw:
<ul>

<li>K:
<ul>

<li>value: 0.8</li>

<li>desc: Normalization (differential flux at the pivot value)</li>

<li>min_value: 1e-30</li>

<li>max_value: 1000.0</li>

<li>unit: keV-1 s-1 cm-2</li>

<li>is_normalization: True</li>

</ul>

</li>

<li>piv:
<ul>

<li>value: 1.0</li>

<li>desc: Pivot value</li>

<li>min_value: None</li>

<li>max_value: None</li>

<li>unit: keV</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>index:
<ul>

<li>value: -1.0</li>

<li>desc: Photon index</li>

<li>min_value: -10.0</li>

<li>max_value: 10.0</li>

<li>unit: </li>

<li>is_normalization: False</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul></div>
</div>
</section>
<section id="Create-a-model">
<h2>Create a model<a class="headerlink" href="#Create-a-model" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Now let‚Äôs create our model, which comprises our two sources:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build a model with the two point sources</span>

<span class="n">my_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">pts1</span><span class="p">,</span> <span class="n">point_source2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Of course you can use as many sources as needed, like my_model = Model(pts1, pts2, pts3‚Ä¶)</p>
</section>
<section id="Getting-information-about-a-model">
<h2>Getting information about a model<a class="headerlink" href="#Getting-information-about-a-model" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Using the <code class="docutils literal notranslate"><span class="pre">.display()</span></code> method we can see all free parameters currently in the model:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Model summary:<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Point sources</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Extended sources</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Particle sources</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><br>Free parameters (6):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.K</th>
      <td>1</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.index</th>
      <td>-2.01</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.K</th>
      <td>0.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.index</th>
      <td>-0.75</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.K</th>
      <td>0.8</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index</th>
      <td>-1</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Fixed parameters (7):<br>(abridged. Use complete=True to see all fixed parameters)<br><br><br>Properties (0):<br><br>(none)<br><br><br>Linked parameters (0):<br><br>(none)<br><br>Independent variables:<br><br>(none)<br><br>Linked functions (0):<br><br>(none)<br></div>
</div>
<p>The model tree can be shown as:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">plot_tree</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #af5fd7; text-decoration-color: #af5fd7; font-weight: bold">model</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚î£‚îÅ‚îÅ </span><span style="color: #af5fd7; text-decoration-color: #af5fd7; font-weight: bold">‚ú® source_1 </span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚î£‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf; font-weight: bold">üî≠ position</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf">ra</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚îÉ   ‚îó‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf">dec</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f; font-weight: bold">üåà spectrum</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">main</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚î£‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">Powerlaw</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">K</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">piv</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚îÉ   ‚îó‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">index</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îÉ   </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚îó‚îÅ‚îÅ </span><span style="color: #00d7ff; text-decoration-color: #00d7ff">polarization</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">‚îó‚îÅ‚îÅ </span><span style="color: #af5fd7; text-decoration-color: #af5fd7; font-weight: bold">‚ú® source_2 </span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚î£‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf; font-weight: bold">üî≠ position</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf">l</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚îÉ   ‚îó‚îÅ‚îÅ </span><span style="color: #00ffaf; text-decoration-color: #00ffaf">b</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f; font-weight: bold">üåà spectrum</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚î£‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">synchrotron</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">Powerlaw</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îÉ   ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">K</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îÉ   ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">piv</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îÉ   ‚îÉ   ‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">index</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îÉ   ‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">polarization</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">    ‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">IC</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚î£‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">Powerlaw</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">K</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚îÉ   ‚î£‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">piv</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚îÉ   ‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">index</span>
<span style="color: #af5fd7; text-decoration-color: #af5fd7">    </span><span style="color: #bcbcbc; text-decoration-color: #bcbcbc">        ‚îó‚îÅ‚îÅ </span><span style="color: #ffff5f; text-decoration-color: #ffff5f">polarization</span>
</pre></div>
</div>
<p>A dictionary of free parameters can be obtained like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">free_parameters</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">free_parameters</span>
</pre></div>
</div>
</div>
<p>We can use such dictionary to loop over all free parameters:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">parameter_name</span><span class="p">,</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="n">free_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameter </span><span class="si">%s</span><span class="s2"> is free&quot;</span> <span class="o">%</span> <span class="n">parameter_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Parameter source_1.spectrum.main.Powerlaw.K is free
Parameter source_1.spectrum.main.Powerlaw.index is free
Parameter source_2.spectrum.synchrotron.Powerlaw.K is free
Parameter source_2.spectrum.synchrotron.Powerlaw.index is free
Parameter source_2.spectrum.IC.Powerlaw.K is free
Parameter source_2.spectrum.IC.Powerlaw.index is free
</pre></div></div>
</div>
<p>More information on a particular source can be obtained like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ul>

<li>source_1 (point source):
<ul>

<li>position:
<ul>

<li>ra:
<ul>

<li>value: 125.6</li>

<li>desc: Right Ascension</li>

<li>min_value: 0.0</li>

<li>max_value: 360.0</li>

<li>unit: deg</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>dec:
<ul>

<li>value: -75.3</li>

<li>desc: Declination</li>

<li>min_value: -90.0</li>

<li>max_value: 90.0</li>

<li>unit: deg</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>equinox: J2000</li>

</ul>

</li>

<li>spectrum:
<ul>

<li>main:
<ul>

<li>Powerlaw:
<ul>

<li>K:
<ul>

<li>value: 1.0</li>

<li>desc: Normalization (differential flux at the pivot value)</li>

<li>min_value: 1e-30</li>

<li>max_value: 1000.0</li>

<li>unit: keV-1 s-1 cm-2</li>

<li>is_normalization: True</li>

</ul>

</li>

<li>piv:
<ul>

<li>value: 1.0</li>

<li>desc: Pivot value</li>

<li>min_value: None</li>

<li>max_value: None</li>

<li>unit: keV</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>index:
<ul>

<li>value: -2.01</li>

<li>desc: Photon index</li>

<li>min_value: -10.0</li>

<li>max_value: 10.0</li>

<li>unit: </li>

<li>is_normalization: False</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul></div>
</div>
<p>More information about a particular instance of a function can be obtained like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ul>

<li>description: A simple power-law</li>

<li>formula: $ K~\frac{x}{piv}^{index} $</li>

<li>parameters:
<ul>

<li>K:
<ul>

<li>value: 1.0</li>

<li>desc: Normalization (differential flux at the pivot value)</li>

<li>min_value: 1e-30</li>

<li>max_value: 1000.0</li>

<li>unit: keV-1 s-1 cm-2</li>

<li>is_normalization: True</li>

<li>delta: 0.1</li>

<li>free: True</li>

</ul>

</li>

<li>piv:
<ul>

<li>value: 1.0</li>

<li>desc: Pivot value</li>

<li>min_value: None</li>

<li>max_value: None</li>

<li>unit: keV</li>

<li>is_normalization: False</li>

<li>delta: 0.1</li>

<li>free: False</li>

</ul>

</li>

<li>index:
<ul>

<li>value: -2.01</li>

<li>desc: Photon index</li>

<li>min_value: -10.0</li>

<li>max_value: 10.0</li>

<li>unit: </li>

<li>is_normalization: False</li>

<li>delta: 0.20099999999999998</li>

<li>free: True</li>

</ul>

</li>

</ul>

</li>

</ul></div>
</div>
</section>
<section id="Accessing-and-modifying-sources-and-parameters-from-the-model-instance">
<h2>Accessing and modifying sources and parameters from the model instance<a class="headerlink" href="#Accessing-and-modifying-sources-and-parameters-from-the-model-instance" title="Permalink to this heading">ÔÉÅ</a></h2>
<section id="Fully-qualified-paths">
<h3>Fully-qualified paths<a class="headerlink" href="#Fully-qualified-paths" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Each source and each parameter has a precise path within the model. These paths are displayed by the .display() method of the model instance (see above), and can be used like <code class="docutils literal notranslate"><span class="pre">my_model.[path]</span></code>. For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Model summary:<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Point sources</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Extended sources</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Particle sources</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><br>Free parameters (6):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.K</th>
      <td>1</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.index</th>
      <td>-2.01</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.K</th>
      <td>0.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.index</th>
      <td>-0.75</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.K</th>
      <td>0.8</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index</th>
      <td>-1</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Fixed parameters (7):<br>(abridged. Use complete=True to see all fixed parameters)<br><br><br>Properties (0):<br><br>(none)<br><br><br>Linked parameters (0):<br><br>(none)<br><br>Independent variables:<br><br>(none)<br><br>Linked functions (0):<br><br>(none)<br></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Access the logK parameters of the powerlaw spectrum of the main component for source 1:</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">logK</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span>

<span class="c1"># Access the logK parameters of the spectrum of the IC component of source 2:</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">IC</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">logK</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.32</span>
</pre></div>
</div>
</div>
<p>The structure of these paths is easy to understand. The model is a tree-like structure. The root of the tree is always the model instance itself. The second level is constituted by the various sources. The structure within a source can be understood by calling the <code class="docutils literal notranslate"><span class="pre">.display</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<ul>

<li>source_1 (point source):
<ul>

<li>position:
<ul>

<li>ra:
<ul>

<li>value: 125.6</li>

<li>desc: Right Ascension</li>

<li>min_value: 0.0</li>

<li>max_value: 360.0</li>

<li>unit: deg</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>dec:
<ul>

<li>value: -75.3</li>

<li>desc: Declination</li>

<li>min_value: -90.0</li>

<li>max_value: 90.0</li>

<li>unit: deg</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>equinox: J2000</li>

</ul>

</li>

<li>spectrum:
<ul>

<li>main:
<ul>

<li>Powerlaw:
<ul>

<li>K:
<ul>

<li>value: 1.0</li>

<li>desc: Normalization (differential flux at the pivot value)</li>

<li>min_value: 1e-30</li>

<li>max_value: 1000.0</li>

<li>unit: keV-1 s-1 cm-2</li>

<li>is_normalization: True</li>

</ul>

</li>

<li>piv:
<ul>

<li>value: 1.0</li>

<li>desc: Pivot value</li>

<li>min_value: None</li>

<li>max_value: None</li>

<li>unit: keV</li>

<li>is_normalization: False</li>

</ul>

</li>

<li>index:
<ul>

<li>value: -2.01</li>

<li>desc: Photon index</li>

<li>min_value: -10.0</li>

<li>max_value: 10.0</li>

<li>unit: </li>

<li>is_normalization: False</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul>

</li>

</ul></div>
</div>
<p>Each indentation represents one level, so to access the ‚Äúra‚Äù element we can follow the levels shown by the <code class="docutils literal notranslate"><span class="pre">.display()</span></code> method:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ra_parameter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">ra</span>

<span class="n">ra_parameter</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Parameter ra = 125.6 [deg]
(min_value = 0.0, max_value = 360.0, delta = 12.56, free = False)</div>
</div>
<div class="admonition note">
<p><strong>Note:</strong> this is a Parameter instance. To get the position of the source as a floating point number, use: <code class="docutils literal notranslate"><span class="pre">my_model.source_1.position.get_ra()</span></code> which will work for any source</p>
</div>
<p>while to access the index parameter of the power law function we can do</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K_parameter</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">K</span>

<span class="n">K_parameter</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Parameter K = 1.0 [1 / (cm2 keV s)]
(min_value = 1e-30, max_value = 1000.0, delta = 0.1, free = True)</div>
</div>
<p>You can find much more information in the document ‚ÄúAdditional features for scripts and applications‚Äù.</p>
<p>These fully-qualified paths are unique to each element, are very descriptive and easy to understand. They can always be used and are encouraged in general, but especially in scripts, when the effort spent writing them is paid off in terms of clarity. However, there is an alternative way which might be more convenient in certain situation, especially when models are simple and the chances of getting confused are low. This alternative method is described below.</p>
</section>
<section id="Using-shortcuts">
<h3>Using shortcuts<a class="headerlink" href="#Using-shortcuts" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Exploiting the feature of the python language, we can create names (‚Äúshortcuts‚Äù) for objects:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a &quot;shortcut&quot; for the spectrum of a source</span>

<span class="n">powerlaw_1</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span>

<span class="c1"># Now we can change the values of that power law as:</span>
<span class="n">powerlaw_1</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="mf">1.2</span>

<span class="c1"># GOTCHA: while it is possible to create shortcuts for parameters, it is not encouraged</span>
<span class="c1"># Indeed, this will not work:</span>
<span class="c1"># logK_1 = my_model.source_1.spectrum.main.powerlaw.logK</span>
<span class="c1"># logK_1 = -1.2 # WILL NOT WORK</span>
<span class="c1"># In order to use a shortcut for a parameter to change its value, you have to explicitly</span>
<span class="c1"># set its property &#39;value&#39;:</span>
<span class="c1"># logK_1.value = -1.2 # This will work</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p><strong>GOTACH:</strong> while it is possible to create shortcuts for parameters, it is not encouraged. Indeed, this will not work:</p>
</div>
<p>K_1 = my_model.source_1.spectrum.main.powerlaw.K</p>
<p>K_1 = 1.2 <em>WILL NOT WORK</em></p>
<p>In order to use a shortcut for a parameter to change its value, you have to explicitly set its property ‚Äòvalue‚Äô: K_1.value = 1.2 <em>This will work</em></p>
<p>Shortcut can point at any point of the tree:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a shortcut of a source</span>
<span class="n">source_1</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span>

<span class="c1"># Now we can do:</span>
<span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.3</span>

<span class="c1"># Create a shortcut for a component</span>

<span class="n">main_component</span> <span class="o">=</span> <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span>

<span class="c1"># Now we can do:</span>
<span class="n">main_component</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.3</span>
</pre></div>
</div>
</div>
<p>If you are ever in doubt of what a particular shortcut stands for, you can always retrieve the full path of the element the shortcut is pointing to like this:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">main_component</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
source_1.spectrum.main
</pre></div></div>
</div>
</section>
</section>
<section id="Saving-a-model-to-file">
<h2>Saving a model to file<a class="headerlink" href="#Saving-a-model-to-file" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>An existing model can be saved to a file with:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Save the model to a file, overwriting it if already existing</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;my_model.yml&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The content of the file is YAML code, which is human-readable and very easy to understand. Let‚Äôs have a look:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;my_model.yml&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">yaml_file</span><span class="p">:</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">yaml_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
source_1 (point source):

  position:

    ra:

      value: 125.6

      desc: Right Ascension

      min_value: 0.0

      max_value: 360.0

      unit: deg

      is_normalization: false

      delta: 12.56

      free: false

    dec:

      value: -75.3

      desc: Declination

      min_value: -90.0

      max_value: 90.0

      unit: deg

      is_normalization: false

      delta: 7.53

      free: false

    equinox: J2000

  spectrum:

    main:

      Powerlaw:

        K:

          value: 1.2

          desc: Normalization (differential flux at the pivot value)

          min_value: 1.0e-30

          max_value: 1000.0

          unit: keV-1 s-1 cm-2

          is_normalization: true

          delta: 0.1

          free: true

        piv:

          value: 1.0

          desc: Pivot value

          min_value: null

          max_value: null

          unit: keV

          is_normalization: false

          delta: 0.1

          free: false

        index:

          value: -1.3

          desc: Photon index

          min_value: -10.0

          max_value: 10.0

          unit: &#39;&#39;

          is_normalization: false

          delta: 0.20099999999999998

          free: true

      polarization: {}

source_2 (point source):

  position:

    l:

      value: 11.25

      desc: Galactic longitude

      min_value: 0.0

      max_value: 360.0

      unit: deg

      is_normalization: false

      delta: 1.125

      free: false

    b:

      value: -22.5

      desc: Galactic latitude

      min_value: -90.0

      max_value: 90.0

      unit: deg

      is_normalization: false

      delta: 2.25

      free: false

    equinox: J2000

  spectrum:

    synchrotron:

      Powerlaw:

        K:

          value: 0.20000000000000004

          desc: Normalization (differential flux at the pivot value)

          min_value: 1.0e-30

          max_value: 1000.0

          unit: keV-1 s-1 cm-2

          is_normalization: true

          delta: 0.1

          free: true

        piv:

          value: 1.0

          desc: Pivot value

          min_value: null

          max_value: null

          unit: keV

          is_normalization: false

          delta: 0.1

          free: false

        index:

          value: -0.75

          desc: Photon index

          min_value: -10.0

          max_value: 10.0

          unit: &#39;&#39;

          is_normalization: false

          delta: 0.20099999999999998

          free: true

      polarization: {}

    IC:

      Powerlaw:

        K:

          value: 0.8

          desc: Normalization (differential flux at the pivot value)

          min_value: 1.0e-30

          max_value: 1000.0

          unit: keV-1 s-1 cm-2

          is_normalization: true

          delta: 0.1

          free: true

        piv:

          value: 1.0

          desc: Pivot value

          min_value: null

          max_value: null

          unit: keV

          is_normalization: false

          delta: 0.1

          free: false

        index:

          value: -1.0

          desc: Photon index

          min_value: -10.0

          max_value: 10.0

          unit: &#39;&#39;

          is_normalization: false

          delta: 0.20099999999999998

          free: true

      polarization: {}


</pre></div></div>
</div>
</section>
<section id="Load-a-model-from-a-file">
<h2>Load a model from a file<a class="headerlink" href="#Load-a-model-from-a-file" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Now suppose that you want to load back a file you created in a previous session. You can do it with:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;my_model.yml&#39;</span><span class="p">)</span>

<span class="c1"># Explore the model we just loaded back</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Model summary:<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Point sources</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Extended sources</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Particle sources</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><br>Free parameters (6):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.K</th>
      <td>1.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.index</th>
      <td>-1.3</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.K</th>
      <td>0.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.index</th>
      <td>-0.75</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.K</th>
      <td>0.8</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index</th>
      <td>-1</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Fixed parameters (7):<br>(abridged. Use complete=True to see all fixed parameters)<br><br><br>Properties (0):<br><br>(none)<br><br><br>Linked parameters (0):<br><br>(none)<br><br>Independent variables:<br><br>(none)<br><br>Linked functions (0):<br><br>(none)<br></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now evaluate and plot our models. You need matplotlib for this</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">jupyterthemes</span> <span class="kn">import</span> <span class="n">jtplot</span>
<span class="n">jtplot</span><span class="o">.</span><span class="n">style</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s2">&quot;talk&quot;</span><span class="p">,</span> <span class="n">fscale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>



<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1"># Energies where we want to evaluate the model</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Loop over the sources</span>

<span class="k">for</span> <span class="n">src_name</span><span class="p">,</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">my_model</span><span class="o">.</span><span class="n">point_sources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="c1"># Loop over the components of each source</span>

    <span class="k">for</span> <span class="n">comp_name</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">src</span><span class="o">.</span><span class="n">components</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

        <span class="c1"># Get the differential flux (in ph/cm2/s)</span>

        <span class="n">flux</span> <span class="o">=</span> <span class="n">component</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="c1"># this can also be accomplished with:</span>
        <span class="c1"># flux = component.powerlaw(e)</span>
        <span class="c1"># but this requires to know the name of the</span>
        <span class="c1"># spectral shape which was used</span>

        <span class="c1"># Plot this component for this source</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">component</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Energy&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Flux (ph cm$^{-2}$ s$^{-1}$ keV$^{-1}$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Flux (ph cm$^{-2}$ s$^{-1}$ keV$^{-1}$&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Model_tutorial_43_1.png" src="../_images/notebooks_Model_tutorial_43_1.png" />
</div>
</div>
</section>
<section id="Linking-parameters">
<h2>Linking parameters<a class="headerlink" href="#Linking-parameters" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Sometimes you want to link two parameters of a model so that they have the same value. This can be easily accomplished in astromodels:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Link the photon index of the first source with the</span>
<span class="c1"># photon index of the IC component of the second source</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">IC</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
              <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Model summary:<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Point sources</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Extended sources</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Particle sources</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><br>Free parameters (5):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.K</th>
      <td>1.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.index</th>
      <td>-1.3</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.K</th>
      <td>0.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.index</th>
      <td>-0.75</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.K</th>
      <td>0.8</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
  </tbody>
</table>
</div><br><br>Fixed parameters (9):<br>(abridged. Use complete=True to see all fixed parameters)<br><br><br>Properties (0):<br><br>(none)<br><br><br>Linked parameters (1):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_2.spectrum.IC.Powerlaw.index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>current value</th>
      <td>-1.3</td>
    </tr>
    <tr>
      <th>function</th>
      <td>Line</td>
    </tr>
    <tr>
      <th>linked to</th>
      <td>source_1.spectrum.main.Powerlaw.index</td>
    </tr>
    <tr>
      <th>unit</th>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Independent variables:<br><br>(none)<br><br>Linked functions (0):<br><br>(none)<br></div>
</div>
<section id="Advanced-use-of-linking:-arbitrary-functions">
<h3>Advanced use of linking: arbitrary functions<a class="headerlink" href="#Advanced-use-of-linking:-arbitrary-functions" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Astromodels takes this a step further. Parameters can be linked to each other through any function. The parameters of the linking function become parameters of the model like any other, and can be left free to vary or fixed. For example, let‚Äôs consider the case where we want the photon index of the IC component of the second source (p2) to be equal to the photon index of the first source (p1) plus a constant. We can link the two parameters with the ‚Äòbias‚Äô function <span class="math notranslate nohighlight">\(f(x) = x + k\)</span>, so that
<span class="math notranslate nohighlight">\(p2(p1) = p1 + k\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Link the photon indexes through the &#39;linear&#39; function, i.e.,</span>
<span class="c1"># the photon index of the IC component of the second source is fixed to be the</span>
<span class="c1"># photon index of the first source plus a constant k</span>

<span class="n">link_function</span> <span class="o">=</span> <span class="n">Line</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">link_function</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">fix</span><span class="o">=</span><span class="kc">True</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">IC</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
              <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
              <span class="n">link_function</span><span class="p">)</span>

<span class="c1"># The parameters of the linking function become parameters</span>
<span class="c1"># of the model, and are put in the model tree under the parameter they are</span>
<span class="c1"># linking.</span>
<span class="c1"># In this case the only parameter of the &#39;linear&#39; function (&#39;k&#39;) becomes then</span>
<span class="c1"># my_model.source_2.spectrum.IC.powerlaw.logK.bias.k</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Model summary:<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Point sources</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Extended sources</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Particle sources</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><br>Free parameters (6):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.K</th>
      <td>1.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.index</th>
      <td>-1.3</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.K</th>
      <td>0.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.index</th>
      <td>-0.75</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.K</th>
      <td>0.8</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.Line.a</th>
      <td>2</td>
      <td>None</td>
      <td>None</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Fixed parameters (8):<br>(abridged. Use complete=True to see all fixed parameters)<br><br><br>Properties (0):<br><br>(none)<br><br><br>Linked parameters (1):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_2.spectrum.IC.Powerlaw.index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>current value</th>
      <td>0.7</td>
    </tr>
    <tr>
      <th>function</th>
      <td>Line</td>
    </tr>
    <tr>
      <th>linked to</th>
      <td>source_1.spectrum.main.Powerlaw.index</td>
    </tr>
    <tr>
      <th>unit</th>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Independent variables:<br><br>(none)<br><br>Linked functions (0):<br><br>(none)<br></div>
</div>
<p>If we want to fix say <span class="math notranslate nohighlight">\(p2 = p1 - 1.2\)</span>, we can fix k to that:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">IC</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">Line</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2</span>
<span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">IC</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">Line</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">fix</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Model summary:<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Point sources</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Extended sources</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Particle sources</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><br>Free parameters (5):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.K</th>
      <td>1.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.index</th>
      <td>-1.3</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.K</th>
      <td>0.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.index</th>
      <td>-0.75</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.K</th>
      <td>0.8</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
  </tbody>
</table>
</div><br><br>Fixed parameters (9):<br>(abridged. Use complete=True to see all fixed parameters)<br><br><br>Properties (0):<br><br>(none)<br><br><br>Linked parameters (1):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_2.spectrum.IC.Powerlaw.index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>current value</th>
      <td>-2.5</td>
    </tr>
    <tr>
      <th>function</th>
      <td>Line</td>
    </tr>
    <tr>
      <th>linked to</th>
      <td>source_1.spectrum.main.Powerlaw.index</td>
    </tr>
    <tr>
      <th>unit</th>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Independent variables:<br><br>(none)<br><br>Linked functions (0):<br><br>(none)<br></div>
</div>
<p>As another example, we might link the two parameters using a power law function:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">IC</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
              <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
              <span class="n">Powerlaw</span><span class="p">())</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Model summary:<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Point sources</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Extended sources</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Particle sources</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><br>Free parameters (7):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.K</th>
      <td>1.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.index</th>
      <td>-1.3</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.K</th>
      <td>0.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.index</th>
      <td>-0.75</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.K</th>
      <td>0.8</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.Powerlaw.K</th>
      <td>1</td>
      <td>1e-30</td>
      <td>1000</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.Powerlaw.index</th>
      <td>-2.01</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Fixed parameters (10):<br>(abridged. Use complete=True to see all fixed parameters)<br><br><br>Properties (0):<br><br>(none)<br><br><br>Linked parameters (1):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_2.spectrum.IC.Powerlaw.index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>current value</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>function</th>
      <td>Powerlaw</td>
    </tr>
    <tr>
      <th>linked to</th>
      <td>source_1.spectrum.main.Powerlaw.index</td>
    </tr>
    <tr>
      <th>unit</th>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Independent variables:<br><br>(none)<br><br>Linked functions (0):<br><br>(none)<br></div>
</div>
<p>We can use arbitrarily complex functions as link function, if needed (see ‚ÄúCreating and modifying functions‚Äù for more info on how to create composite functions):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A random composite function (see &quot;Creating and modifying functions&quot; for more info)</span>
<span class="n">crazy_link</span> <span class="o">=</span> <span class="n">Powerlaw</span><span class="p">()</span> <span class="o">+</span> <span class="n">Gaussian</span><span class="p">()</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">IC</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
              <span class="n">my_model</span><span class="o">.</span><span class="n">source_1</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
              <span class="n">crazy_link</span><span class="p">)</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
Model summary:<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Point sources</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Extended sources</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Particle sources</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div><br><br>Free parameters (12):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
      <th>min_value</th>
      <th>max_value</th>
      <th>unit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.K</th>
      <td>1.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_1.spectrum.main.Powerlaw.index</th>
      <td>-1.3</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.K</th>
      <td>0.2</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.synchrotron.Powerlaw.index</th>
      <td>-0.75</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.K</th>
      <td>0.8</td>
      <td>1e-30</td>
      <td>1000</td>
      <td>keV-1 s-1 cm-2</td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.Powerlaw.K</th>
      <td>1</td>
      <td>1e-30</td>
      <td>1000</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.Powerlaw.index</th>
      <td>-2.01</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.composite.K_1</th>
      <td>1</td>
      <td>1e-30</td>
      <td>1000</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.composite.index_1</th>
      <td>-2.01</td>
      <td>-10</td>
      <td>10</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.composite.F_2</th>
      <td>1</td>
      <td>None</td>
      <td>None</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.composite.mu_2</th>
      <td>0</td>
      <td>None</td>
      <td>None</td>
      <td></td>
    </tr>
    <tr>
      <th>source_2.spectrum.IC.Powerlaw.index.composite.sigma_2</th>
      <td>1</td>
      <td>1e-12</td>
      <td>None</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Fixed parameters (11):<br>(abridged. Use complete=True to see all fixed parameters)<br><br><br>Properties (0):<br><br>(none)<br><br><br>Linked parameters (1):<br><br><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_2.spectrum.IC.Powerlaw.index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>current value</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>function</th>
      <td>composite</td>
    </tr>
    <tr>
      <th>linked to</th>
      <td>source_1.spectrum.main.Powerlaw.index</td>
    </tr>
    <tr>
      <th>unit</th>
      <td></td>
    </tr>
  </tbody>
</table>
</div><br><br>Independent variables:<br><br>(none)<br><br>Linked functions (0):<br><br>(none)<br></div>
</div>
</section>
</section>
<section id="Time-varying-models-and-other-independent-variables">
<h2>Time-varying models and other independent variables<a class="headerlink" href="#Time-varying-models-and-other-independent-variables" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>In astromodels parameters can become functions of independent variables such as time. This is accomplished in a way which is similar to the procedure to link parameters described above. First, let‚Äôs create an independent variable. An IndependentVariable instance is created and added to the model like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the time as an independent variable of the model</span>

<span class="n">time</span> <span class="o">=</span> <span class="n">IndependentVariable</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">add_independent_variable</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The IndependentVariable instance is inserted at the root of the model tree. In this case, can be accessed as:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
IndependentVariable time = 0.0
(min_value = None, max_value = None)</div>
</div>
<p>We can now link any parameter to be a function of time, like this:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First define the function. In this case, a linear function ax+b</span>
<span class="n">law</span> <span class="o">=</span> <span class="n">Line</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span><span class="n">b</span><span class="o">=-</span><span class="mf">0.02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now link the index of the sync. component of source_2 to be law(t) i.e., <span class="math notranslate nohighlight">\(index = law(t) = a*t + b\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">link</span><span class="p">(</span><span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">synchrotron</span><span class="o">.</span><span class="n">Powerlaw</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
             <span class="n">time</span><span class="p">,</span>
             <span class="n">law</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;time_dependent.yml&quot;</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">my_model</span> <span class="o">=</span> <span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;time_dependent.yml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This would show the link:</p>
<div class="highlight-my_model.display()``` notranslate"><div class="highlight"><pre><span></span>Now changing the value of time will change the value of the parameter
according to the law. For example, let&#39;s loop over 10 s and print
the value of the parameter


```python
# Reset time
my_model.time = 0.0

for i in range(10):

    my_model.time = my_model.time.value + 1.0

    print(&quot;At time %s s the value of the parameter is %s&quot; % (my_model.time.value,
                    my_model.source_2.spectrum.synchrotron.Powerlaw.index.value))
</pre></div>
</div>
<p>Now plot the synch. spectrum of the source at different times (you will need matplotlib for this)</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1"># Prepare 100 logarithmically distributed energies between 1 and 100 keV</span>
<span class="n">energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Compute and plot the sync. spectrum every 10 s between 0 and 50 seconds</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

<span class="n">my_model</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">for</span> <span class="n">tt</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>

    <span class="n">my_model</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">tt</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">energies</span><span class="p">,</span> <span class="n">my_model</span><span class="o">.</span><span class="n">source_2</span><span class="o">.</span><span class="n">spectrum</span><span class="o">.</span><span class="n">synchrotron</span><span class="p">(</span><span class="n">energies</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;t = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">my_model</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Energy (keV)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Differential flux (ph. cm$^{-2}$ s$^{-1}$ keV$^{-1}$)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;Differential flux (ph. cm$^{-2}$ s$^{-1}$ keV$^{-1}$)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Model_tutorial_64_1.png" src="../_images/notebooks_Model_tutorial_64_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Multi_component_sources.html" class="btn btn-neutral float-left" title="Multi-component sources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Priors_for_Bayesian_analysis.html" class="btn btn-neutral float-right" title="Priors for Bayesian analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016--2022, G.Vianello, J. M. Burgess, N. Di Lalla, N. Omodei, H. Fleischhack.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>