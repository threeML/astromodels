<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>astromodels.functions.functions_1D.powerlaws &mdash; Astromodels latest documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sg_gallery.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/dark_mode_css/general.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/dark_mode_css/dark.css" />

  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="../../../../_static/dark_mode_js/default_dark.js"></script>
        <script src="../../../../_static/dark_mode_js/theme_switcher.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Astromodels
              <img src="../../../../_static/transp_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Quick_start.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/function_list.html">Available Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Functions_tutorial.html">Functions tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Point_source_tutorial.html">Point sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Extended_sources_tutorial.html">Extended source tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Multi_component_sources.html">Multi-component sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Model_tutorial.html">Model tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Priors_for_Bayesian_analysis.html">Priors for Bayesian analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../notebooks/Additional_features_for_scripts_and_applications.html">Additional features for scripts and applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/API.html#astromodels">astromodels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/API.html#astromodels-package">astromodels package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../release_notes.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Astromodels</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">astromodels.functions.functions_1D.powerlaws</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for astromodels.functions.functions_1D.powerlaws</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span>

<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">astropy_units</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">from</span> <span class="nn">past.utils</span> <span class="kn">import</span> <span class="n">old_div</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">erfcinv</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">gammaincc</span>

<span class="kn">import</span> <span class="nn">astromodels.functions.numba_functions</span> <span class="k">as</span> <span class="nn">nb_func</span>
<span class="kn">from</span> <span class="nn">astromodels.core.units</span> <span class="kn">import</span> <span class="n">get_units</span>
<span class="kn">from</span> <span class="nn">astromodels.functions.function</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Function1D</span><span class="p">,</span>
    <span class="n">FunctionMeta</span><span class="p">,</span>
    <span class="n">ModelAssertionViolation</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">threeML.config.config</span> <span class="kn">import</span> <span class="n">threeML_config</span>

    <span class="n">_has_threeml</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>

    <span class="n">_has_threeml</span> <span class="o">=</span> <span class="kc">False</span>


<span class="kn">from</span> <span class="nn">astromodels.utils.logging</span> <span class="kn">import</span> <span class="n">setup_logger</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">setup_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;giacomov&quot;</span>
<span class="c1"># DMFitFunction and DMSpectra add by Andrea Albert (aalbert@slac.stanford.edu) Oct 26, 2016</span>

<span class="n">erg2keV</span> <span class="o">=</span> <span class="mf">6.24151e8</span>


<div class="viewcode-block" id="Powerlaw"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Powerlaw">[docs]</a><span class="k">class</span> <span class="nc">Powerlaw</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        A simple power-law</span>

<span class="sd">    latex : $ K~\frac{x}{piv}^{index} $</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : Normalization (differential flux at the pivot value)</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>
<span class="sd">            min : 1e-30</span>
<span class="sd">            max : 1e3</span>
<span class="sd">            delta : 0.1</span>

<span class="sd">        piv :</span>

<span class="sd">            desc : Pivot value</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            fix : yes</span>

<span class="sd">        index :</span>

<span class="sd">            desc : Photon index</span>
<span class="sd">            initial value : -2.01</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>

<span class="sd">    tests :</span>
<span class="sd">        - { x : 10, function value: 0.01, tolerance: 1e-20}</span>
<span class="sd">        - { x : 100, function value: 0.0001, tolerance: 1e-20}</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The index is always dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="c1"># The pivot energy has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># The normalization has the same units as the y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

    <span class="c1"># noinspection PyPep8Naming</span>
<div class="viewcode-block" id="Powerlaw.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Powerlaw.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">index_</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">value</span>
            <span class="n">K_</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">value</span>
            <span class="n">piv_</span> <span class="o">=</span> <span class="n">piv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">K_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">index_</span> <span class="o">=</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">index</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">plaw_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span> <span class="o">*</span> <span class="n">unit_</span></div></div>


<span class="c1"># noinspection PyPep8Naming</span>


<div class="viewcode-block" id="Powerlaw_flux"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Powerlaw_flux">[docs]</a><span class="k">class</span> <span class="nc">Powerlaw_flux</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        A simple power-law with the photon flux in a band used as normalization. This will reduce the correlation</span>
<span class="sd">        between the index and the normalization.</span>

<span class="sd">    latex : $ \frac{F(\gamma+1)} {b^{\gamma+1} - a^{\gamma+1}} (x)^{\gamma}$</span>

<span class="sd">    parameters :</span>

<span class="sd">        F :</span>

<span class="sd">            desc : Integral between a and b</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>
<span class="sd">            min : 1e-30</span>
<span class="sd">            max : 1e3</span>
<span class="sd">            delta : 0.1</span>

<span class="sd">        index :</span>

<span class="sd">            desc : Photon index</span>
<span class="sd">            initial value : -2</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>

<span class="sd">        a :</span>

<span class="sd">            desc : lower bound for the band in which computing the integral F</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            fix : yes</span>

<span class="sd">        b :</span>

<span class="sd">            desc : upper bound for the band in which computing the integral F</span>
<span class="sd">            initial value : 100.0</span>
<span class="sd">            fix : yes</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The flux is the integral over x, so:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">F</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span> <span class="o">*</span> <span class="n">x_unit</span>

        <span class="c1"># The index is always dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="c1"># a and b have the same units as x</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

    <span class="c1"># noinspection PyPep8Naming</span>
<div class="viewcode-block" id="Powerlaw_flux.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Powerlaw_flux.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">index_</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">value</span>
            <span class="n">F_</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">value</span>
            <span class="n">a_</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
            <span class="n">b_</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">yunit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>
            <span class="n">xunit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">yunit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">xunit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">F_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span> <span class="o">=</span> <span class="n">F</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>

        <span class="n">gp1</span> <span class="o">=</span> <span class="n">index_</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="n">F_</span> <span class="o">*</span> <span class="n">gp1</span> <span class="o">/</span> <span class="p">(((</span><span class="n">b_</span><span class="p">)</span> <span class="o">**</span> <span class="n">gp1</span> <span class="o">-</span> <span class="p">(</span><span class="n">a_</span><span class="p">)</span> <span class="o">**</span> <span class="n">gp1</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">plaw_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">yunit_</span></div></div>


<div class="viewcode-block" id="Powerlaw_Eflux"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Powerlaw_Eflux">[docs]</a><span class="k">class</span> <span class="nc">Powerlaw_Eflux</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>
<span class="sd">        A  power-law where the normalization is the energy flux defined between a and b</span>
<span class="sd">    latex : $F~\frac{x}{piv}^{index} $</span>
<span class="sd">    parameters :</span>
<span class="sd">        F :</span>
<span class="sd">            desc : Normalization (energy flux at the between a and b) erg /cm2 s</span>
<span class="sd">            initial value : 1.e-5</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>
<span class="sd">            min : 1e-30</span>
<span class="sd">            max : 1e3</span>
<span class="sd">            delta : 0.1</span>
<span class="sd">        piv :</span>
<span class="sd">            desc : Pivot value</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            fix : yes</span>
<span class="sd">        index :</span>
<span class="sd">            desc : Photon index</span>
<span class="sd">            initial value : -2</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>


<span class="sd">        a :</span>
<span class="sd">            desc : lower energy integral bound (keV)</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            min : 0</span>
<span class="sd">            fix: yes</span>

<span class="sd">        b :</span>
<span class="sd">            desc : upper energy integral bound (keV)</span>
<span class="sd">            initial value : 100</span>
<span class="sd">            min : 0</span>
<span class="sd">            fix: yes</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The index is always dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="c1"># The pivot energy has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># a and b have the same units of x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># The normalization has the same units as the y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">F</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span> <span class="o">*</span> <span class="n">x_unit</span>

    <span class="c1"># noinspection PyPep8Naming</span>
<div class="viewcode-block" id="Powerlaw_Eflux.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Powerlaw_Eflux.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">index_</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">value</span>
            <span class="n">F_</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">value</span>
            <span class="n">piv_</span> <span class="o">=</span> <span class="n">piv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>
            <span class="n">a_</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
            <span class="n">b_</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span>

            <span class="n">yunit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>
            <span class="n">xunit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">yunit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">xunit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">F_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span> <span class="o">=</span> <span class="n">F</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>

        <span class="n">intflux</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">plaw_flux_norm</span><span class="p">(</span><span class="n">index_</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">)</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_</span> <span class="o">/</span> <span class="p">(</span><span class="n">intflux</span><span class="p">))</span> <span class="o">*</span> <span class="n">erg2keV</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">plaw_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">out</span> <span class="o">*</span> <span class="n">yunit_</span></div></div>


<div class="viewcode-block" id="Cutoff_powerlaw"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Cutoff_powerlaw">[docs]</a><span class="k">class</span> <span class="nc">Cutoff_powerlaw</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        A power law multiplied by an exponential cutoff</span>

<span class="sd">    latex : $ K~\frac{x}{piv}^{index}~\exp{-x/xc} $</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : Normalization (differential flux at the pivot value)</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>
<span class="sd">            min : 1e-30</span>
<span class="sd">            max : 1e3</span>
<span class="sd">            delta : 0.1</span>

<span class="sd">        piv :</span>

<span class="sd">            desc : Pivot value</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            fix : yes</span>

<span class="sd">        index :</span>

<span class="sd">            desc : Photon index</span>
<span class="sd">            initial value : -2</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>

<span class="sd">        xc :</span>

<span class="sd">            desc : Cutoff energy</span>
<span class="sd">            initial value : 10.0</span>
<span class="sd">            transformation : log10</span>
<span class="sd">            min: 1.0</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The index is always dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="c1"># The pivot energy has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># The normalization has the same units as the y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

    <span class="c1"># noinspectionq PyPep8Naming</span>
<div class="viewcode-block" id="Cutoff_powerlaw.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Cutoff_powerlaw.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">xc</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">index_</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">value</span>
            <span class="n">K_</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">value</span>
            <span class="n">piv_</span> <span class="o">=</span> <span class="n">piv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">xc_</span> <span class="o">=</span> <span class="n">xc</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">K_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">xc_</span> <span class="o">=</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">xc</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">cplaw_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">xc_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span> <span class="o">*</span> <span class="n">unit_</span></div></div>


<div class="viewcode-block" id="Cutoff_powerlaw_Ep"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Cutoff_powerlaw_Ep">[docs]</a><span class="k">class</span> <span class="nc">Cutoff_powerlaw_Ep</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        A power law multiplied by an exponential cutoff parametrized with Ep</span>

<span class="sd">    latex : $ K~\frac{x}{piv}^{index}~\exp{-x(2+index)/xp} $</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : Normalization (differential flux at the pivot value)</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>
<span class="sd">            min : 1e-30</span>
<span class="sd">            max : 1e3</span>
<span class="sd">            delta : 0.1</span>

<span class="sd">        piv :</span>

<span class="sd">            desc : Pivot value</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            fix : yes</span>

<span class="sd">        index :</span>

<span class="sd">            desc : Photon index</span>
<span class="sd">            initial value : -2</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>

<span class="sd">        xp :</span>

<span class="sd">            desc : peak in the x * x * N (nuFnu if x is a energy)</span>
<span class="sd">            initial value : 500</span>
<span class="sd">            min : 10</span>
<span class="sd">            max : 1e4</span>
<span class="sd">            transformation : log10</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The index is always dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="c1"># The pivot energy has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">xp</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># The normalization has the same units as the y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

    <span class="c1"># noinspectionq PyPep8Naming</span>
<div class="viewcode-block" id="Cutoff_powerlaw_Ep.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Cutoff_powerlaw_Ep.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">xp</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">index_</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">value</span>
            <span class="n">K_</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">value</span>
            <span class="n">piv_</span> <span class="o">=</span> <span class="n">piv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">xp_</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">K_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">xp_</span> <span class="o">=</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">xp</span>

        <span class="n">xc</span> <span class="o">=</span> <span class="n">xp</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">index</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">cplaw_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span> <span class="o">*</span> <span class="n">unit_</span></div></div>


<div class="viewcode-block" id="Inverse_cutoff_powerlaw"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Inverse_cutoff_powerlaw">[docs]</a><span class="k">class</span> <span class="nc">Inverse_cutoff_powerlaw</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>
<span class="sd">        A power law multiplied by an exponential cutoff [Note: instead of cutoff energy energy parameter xc, b = 1/xc is used]</span>
<span class="sd">    latex : $K \frac{x}{piv}^{index}\exp{(-x~b)} $</span>
<span class="sd">    parameters :</span>
<span class="sd">        K :</span>
<span class="sd">            desc : Normalization (differential flux at the pivot value)</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>
<span class="sd">            min : 1e-30</span>
<span class="sd">            max : 1e3</span>
<span class="sd">            delta : 0.1</span>
<span class="sd">        piv :</span>
<span class="sd">            desc : Pivot value</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            fix : yes</span>
<span class="sd">        index :</span>
<span class="sd">            desc : Photon index</span>
<span class="sd">            initial value : -2</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>
<span class="sd">        b :</span>
<span class="sd">            desc : inverse cutoff energy i.e 1/xc</span>
<span class="sd">            initial value : 1</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The index is always dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="c1"># The pivot energy has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">x_unit</span>

        <span class="c1"># The normalization has the same units as the y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

    <span class="c1"># noinspectionq PyPep8Naming</span>
<div class="viewcode-block" id="Inverse_cutoff_powerlaw.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Inverse_cutoff_powerlaw.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">index_</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">value</span>
            <span class="n">K_</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">value</span>
            <span class="n">piv_</span> <span class="o">=</span> <span class="n">piv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">b_</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">K_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">b_</span> <span class="o">=</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">b</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">cplaw_inverse_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">b_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span> <span class="o">*</span> <span class="n">unit_</span></div></div>


<div class="viewcode-block" id="Super_cutoff_powerlaw"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Super_cutoff_powerlaw">[docs]</a><span class="k">class</span> <span class="nc">Super_cutoff_powerlaw</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        A power law with a super-exponential cutoff</span>

<span class="sd">    latex : $ K~\frac{x}{piv}^{index}~\exp{(-x/xc)^{\gamma}} $</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : Normalization (differential flux at the pivot value)</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            min : 1e-50</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        piv :</span>

<span class="sd">            desc : Pivot value</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            fix : yes</span>

<span class="sd">        index :</span>

<span class="sd">            desc : Photon index</span>
<span class="sd">            initial value : -2</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>

<span class="sd">        xc :</span>

<span class="sd">            desc : Cutoff energy</span>
<span class="sd">            initial value : 10.0</span>
<span class="sd">            min : 1.0</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        gamma :</span>

<span class="sd">            desc : Index of the super-exponential cutoff</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            min : 0.1</span>
<span class="sd">            max : 10.0</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The index is always dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="c1"># The pivot energy has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># The cutoff has the same dimensions as x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># The normalization has the same units as the y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

    <span class="c1"># noinspection PyPep8Naming</span>
<div class="viewcode-block" id="Super_cutoff_powerlaw.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Super_cutoff_powerlaw.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">index_</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">value</span>
            <span class="n">K_</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">value</span>
            <span class="n">piv_</span> <span class="o">=</span> <span class="n">piv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">xc_</span> <span class="o">=</span> <span class="n">xc</span><span class="o">.</span><span class="n">value</span>
            <span class="n">gamma_</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">K_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">xc_</span><span class="p">,</span> <span class="n">gamma_</span> <span class="o">=</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">gamma</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">super_cplaw_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">index_</span><span class="p">,</span> <span class="n">xc_</span><span class="p">,</span> <span class="n">gamma_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span> <span class="o">*</span> <span class="n">unit_</span></div></div>


<div class="viewcode-block" id="SmoothlyBrokenPowerLaw"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.SmoothlyBrokenPowerLaw">[docs]</a><span class="k">class</span> <span class="nc">SmoothlyBrokenPowerLaw</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        A Smoothly Broken Power Law</span>

<span class="sd">    Latex : $  $</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : normalization</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            min : 1e-50</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>


<span class="sd">        alpha :</span>

<span class="sd">            desc : power law index below the break</span>
<span class="sd">            initial value : -1</span>
<span class="sd">            min : -1.5</span>
<span class="sd">            max : 2</span>

<span class="sd">        break_energy:</span>

<span class="sd">            desc: location of the peak</span>
<span class="sd">            initial value : 300</span>
<span class="sd">            fix : no</span>
<span class="sd">            min : 10</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        break_scale :</span>

<span class="sd">            desc: smoothness of the break</span>
<span class="sd">            initial value : 0.5</span>
<span class="sd">            min : 0.</span>
<span class="sd">            max : 10.</span>
<span class="sd">            fix : yes</span>

<span class="sd">        beta:</span>

<span class="sd">            desc : power law index above the break</span>
<span class="sd">            initial value : -2.</span>
<span class="sd">            min : -5.0</span>
<span class="sd">            max : -1.6</span>

<span class="sd">        pivot:</span>

<span class="sd">            desc: where the spectrum is normalized</span>
<span class="sd">            initial value : 100.</span>
<span class="sd">            fix: yes</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>

        <span class="c1"># norm has same unit as energy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">break_energy</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pivot</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">break_scale</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

<div class="viewcode-block" id="SmoothlyBrokenPowerLaw.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.SmoothlyBrokenPowerLaw.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">break_energy</span><span class="p">,</span> <span class="n">break_scale</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">pivot</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">alpha_</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">value</span>
            <span class="n">beta_</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">value</span>
            <span class="n">K_</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">value</span>
            <span class="n">pivot_</span> <span class="o">=</span> <span class="n">pivot</span><span class="o">.</span><span class="n">value</span>
            <span class="n">break_energy_</span> <span class="o">=</span> <span class="n">break_energy</span><span class="o">.</span><span class="n">value</span>
            <span class="n">break_scale_</span> <span class="o">=</span> <span class="n">break_scale</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">K_</span><span class="p">,</span> <span class="n">pivot_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">break_scale_</span><span class="p">,</span> <span class="n">break_energy_</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">K</span><span class="p">,</span>
                <span class="n">pivot</span><span class="p">,</span>
                <span class="n">x</span><span class="p">,</span>
                <span class="n">alpha</span><span class="p">,</span>
                <span class="n">beta</span><span class="p">,</span>
                <span class="n">break_scale</span><span class="p">,</span>
                <span class="n">break_energy</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">sbplaw_eval</span><span class="p">(</span>
            <span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">alpha_</span><span class="p">,</span> <span class="n">break_energy</span><span class="p">,</span> <span class="n">break_scale_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">pivot_</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span> <span class="o">*</span> <span class="n">unit_</span></div></div>


<div class="viewcode-block" id="Broken_powerlaw"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Broken_powerlaw">[docs]</a><span class="k">class</span> <span class="nc">Broken_powerlaw</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        A broken power law function</span>

<span class="sd">    latex : $ f(x)= K~\begin{cases}\left( \frac{x}{x_{b}} \right)^{\alpha} &amp; x &lt; x_{b} \\ \left( \frac{x}{x_{b}} \right)^{\beta} &amp; x \ge x_{b} \end{cases} $</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : Normalization (differential flux at x_b)</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            min : 1e-50</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        xb :</span>

<span class="sd">            desc : Break point</span>
<span class="sd">            initial value : 10</span>
<span class="sd">            min : 1.0</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        alpha :</span>

<span class="sd">            desc : Index before the break xb</span>
<span class="sd">            initial value : -1.5</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>

<span class="sd">        beta :</span>

<span class="sd">            desc : Index after the break xb</span>
<span class="sd">            initial value : -2.5</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>

<span class="sd">        piv :</span>

<span class="sd">            desc : Pivot energy</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            fix : yes</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The normalization has the same units as y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

        <span class="c1"># The break point has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xb</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># alpha and beta are dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

    <span class="c1"># noinspection PyPep8Naming</span>
<div class="viewcode-block" id="Broken_powerlaw.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Broken_powerlaw.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">piv</span><span class="p">):</span>
        <span class="c1"># The K * 0 is to keep the units right. If the input has unit, this will make a result</span>
        <span class="c1"># array with the same units as K. If the input has no units, this will have no</span>
        <span class="c1"># effect whatsoever</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">alpha_</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">value</span>
            <span class="n">beta_</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">value</span>
            <span class="n">K_</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">value</span>
            <span class="n">xb_</span> <span class="o">=</span> <span class="n">xb</span><span class="o">.</span><span class="n">value</span>
            <span class="n">piv_</span> <span class="o">=</span> <span class="n">piv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">xb_</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">xb</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">bplaw_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">xb_</span><span class="p">,</span> <span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span> <span class="o">*</span> <span class="n">unit_</span></div></div>


<div class="viewcode-block" id="Band"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Band">[docs]</a><span class="k">class</span> <span class="nc">Band</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        Band model from Band et al., 1993, parametrized with the peak energy</span>

<span class="sd">    latex : $K \begin{cases} \left(\frac{x}{piv}\right)^{\alpha} \exp \left(-\frac{(2+\alpha) x}{x_{p}}\right) &amp; x \leq (\alpha-\beta) \frac{x_{p}}{(\alpha+2)} \\ \left(\frac{x}{piv}\right)^{\beta} \exp (\beta-\alpha)\left[\frac{(\alpha-\beta) x_{p}}{piv(2+\alpha)}\right]^{\alpha-\beta} &amp;x&gt;(\alpha-\beta) \frac{x_{p}}{(\alpha+2)} \end{cases} $</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : Differential flux at the pivot energy</span>
<span class="sd">            initial value : 1e-4</span>
<span class="sd">            min : 1e-50</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        alpha :</span>

<span class="sd">            desc : low-energy photon index</span>
<span class="sd">            initial value : -1.0</span>
<span class="sd">            min : -1.5</span>
<span class="sd">            max : 3</span>

<span class="sd">        xp :</span>

<span class="sd">            desc : peak in the x * x * N (nuFnu if x is a energy)</span>
<span class="sd">            initial value : 500</span>
<span class="sd">            min : 10</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        beta :</span>

<span class="sd">            desc : high-energy photon index</span>
<span class="sd">            initial value : -2.0</span>
<span class="sd">            min : -5.0</span>
<span class="sd">            max : -1.6</span>

<span class="sd">        piv :</span>

<span class="sd">            desc : pivot energy</span>
<span class="sd">            initial value : 100.0</span>
<span class="sd">            fix : yes</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The normalization has the same units as y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

        <span class="c1"># The break point has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xp</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># alpha and beta are dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

<div class="viewcode-block" id="Band.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Band.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">piv</span><span class="p">):</span>
        <span class="n">E0</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="n">beta</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">beta</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Alpha is currently less than beta. Setting alpha = beta.&quot;</span><span class="p">)</span>
            <span class="c1"># raise ModelAssertionViolation(&quot;Alpha cannot be less than beta&quot;)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>
            <span class="n">alpha_</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">value</span>
            <span class="n">beta_</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">value</span>
            <span class="n">K_</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">value</span>
            <span class="n">E0_</span> <span class="o">=</span> <span class="n">E0</span><span class="o">.</span><span class="n">value</span>
            <span class="n">piv_</span> <span class="o">=</span> <span class="n">piv</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">,</span> <span class="n">x_</span><span class="p">,</span> <span class="n">E0_</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">E0</span>

        <span class="k">return</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">band_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">E0_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit_</span></div></div>


<div class="viewcode-block" id="Band_grbm"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Band_grbm">[docs]</a><span class="k">class</span> <span class="nc">Band_grbm</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        Band model from Band et al., 1993, parametrized with the cutoff energy</span>

<span class="sd">    latex : $  $</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : Differential flux at the pivot energy</span>
<span class="sd">            initial value : 1e-4</span>
<span class="sd">            min : 1e-50</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        alpha :</span>

<span class="sd">            desc : low-energy photon index</span>
<span class="sd">            initial value : -1.0</span>
<span class="sd">            min : -1.5</span>
<span class="sd">            max : 3</span>

<span class="sd">        xc :</span>

<span class="sd">            desc : cutoff of exp</span>
<span class="sd">            initial value : 500</span>
<span class="sd">            min : 10</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        beta :</span>

<span class="sd">            desc : high-energy photon index</span>
<span class="sd">            initial value : -2.0</span>
<span class="sd">            min : -5.0</span>
<span class="sd">            max : -1.6</span>

<span class="sd">        piv :</span>

<span class="sd">            desc : pivot energy</span>
<span class="sd">            initial value : 100.0</span>
<span class="sd">            fix : yes</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The normalization has the same units as y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

        <span class="c1"># The break point has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># alpha and beta are dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

<div class="viewcode-block" id="Band_grbm.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Band_grbm.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">xc</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">piv</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="n">beta</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ModelAssertionViolation</span><span class="p">(</span><span class="s2">&quot;Alpha cannot be less than beta&quot;</span><span class="p">)</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">xc</span>

        <span class="c1"># The K * 0 part is a trick so that out will have the right units (if the input</span>
        <span class="c1"># has units)</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">*</span> <span class="n">K</span> <span class="o">*</span> <span class="mi">0</span>

        <span class="n">out</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">K</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">piv</span><span class="p">),</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">xc</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">out</span><span class="p">[</span><span class="o">~</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">K</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">xc</span> <span class="o">/</span> <span class="n">piv</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">old_div</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">idx</span><span class="p">],</span> <span class="n">piv</span><span class="p">),</span> <span class="n">beta</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">out</span></div></div>


<div class="viewcode-block" id="Band_Calderone"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Band_Calderone">[docs]</a><span class="k">class</span> <span class="nc">Band_Calderone</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description :</span>

<span class="sd">        The Band model from Band et al. 1993, implemented however in a way which reduces the covariances between</span>
<span class="sd">        the parameters (Calderone et al., MNRAS, 448, 403C, 2015)</span>

<span class="sd">    latex : $ \text{(Calderone et al., MNRAS, 448, 403C, 2015)} $</span>

<span class="sd">    parameters :</span>

<span class="sd">        alpha :</span>
<span class="sd">            desc : The index for x smaller than the x peak</span>
<span class="sd">            initial value : -1</span>
<span class="sd">            min : -10</span>
<span class="sd">            max : 10</span>

<span class="sd">        beta :</span>

<span class="sd">            desc : index for x greater than the x peak (only if opt=1, i.e., for the</span>
<span class="sd">                   Band model)</span>
<span class="sd">            initial value : -2.2</span>
<span class="sd">            min : -7</span>
<span class="sd">            max : -1</span>

<span class="sd">        xp :</span>

<span class="sd">            desc : position of the peak in the x*x*f(x) space (if x is energy, this is the nuFnu or SED space)</span>
<span class="sd">            initial value : 200.0</span>
<span class="sd">            min : 1e-10</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        F :</span>

<span class="sd">            desc : integral in the band defined by a and b</span>
<span class="sd">            initial value : 1e-6</span>
<span class="sd">            min: 1e-50</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        a:</span>

<span class="sd">            desc : lower limit of the band in which the integral will be computed</span>
<span class="sd">            initial value : 1.0</span>
<span class="sd">            min : 0</span>
<span class="sd">            fix : yes</span>

<span class="sd">        b:</span>

<span class="sd">            desc : upper limit of the band in which the integral will be computed</span>
<span class="sd">            initial value : 10000.0</span>
<span class="sd">            min : 0</span>
<span class="sd">            fix : yes</span>

<span class="sd">        opt :</span>

<span class="sd">            desc : option to select the spectral model (0 corresponds to a cutoff power law, 1 to the Band model)</span>
<span class="sd">            initial value : 1</span>
<span class="sd">            min : 0</span>
<span class="sd">            max : 1</span>
<span class="sd">            fix : yes</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>

        <span class="c1"># alpha and beta are always unitless</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="c1"># xp has the same dimension as x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xp</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># F is the integral over x, so it has dimensions y_unit * x_unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">F</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span> <span class="o">*</span> <span class="n">x_unit</span>

        <span class="c1"># a and b have the same units of x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># opt is just a flag, and has no units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

<div class="viewcode-block" id="Band_Calderone.ggrb_int_cpl"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Band_Calderone.ggrb_int_cpl">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ggrb_int_cpl</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">Ec</span><span class="p">,</span> <span class="n">Emin</span><span class="p">,</span> <span class="n">Emax</span><span class="p">):</span>

        <span class="c1"># Gammaincc does not support quantities</span>
        <span class="n">i1</span> <span class="o">=</span> <span class="n">gammaincc</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="n">old_div</span><span class="p">(</span><span class="n">Emin</span><span class="p">,</span> <span class="n">Ec</span><span class="p">))</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">i2</span> <span class="o">=</span> <span class="n">gammaincc</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="n">old_div</span><span class="p">(</span><span class="n">Emax</span><span class="p">,</span> <span class="n">Ec</span><span class="p">))</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span>

        <span class="k">return</span> <span class="o">-</span><span class="n">Ec</span> <span class="o">*</span> <span class="n">Ec</span> <span class="o">*</span> <span class="p">(</span><span class="n">i2</span> <span class="o">-</span> <span class="n">i1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Band_Calderone.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.Band_Calderone.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">opt</span><span class="p">):</span>

        <span class="k">assert</span> <span class="n">opt</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">opt</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Opt must be either 0 or 1&quot;</span>

        <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="n">beta</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ModelAssertionViolation</span><span class="p">(</span><span class="s2">&quot;Alpha cannot be smaller than beta&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ModelAssertionViolation</span><span class="p">(</span><span class="s2">&quot;Alpha cannot be smaller than -2&quot;</span><span class="p">)</span>

        <span class="c1"># Cutoff energy</span>

        <span class="k">if</span> <span class="n">alpha</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>

            <span class="n">Ec</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">)</span>  <span class="c1"># TRICK: avoid a=-2</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">Ec</span> <span class="o">=</span> <span class="n">old_div</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">))</span>

        <span class="c1"># Split energy</span>

        <span class="n">Esplit</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ec</span>

        <span class="c1"># Evaluate model integrated flux and normalization</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>

            <span class="c1"># The following functions do not allow the use of units</span>
            <span class="n">alpha_</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">.</span><span class="n">value</span>
            <span class="n">Ec_</span> <span class="o">=</span> <span class="n">Ec</span><span class="o">.</span><span class="n">value</span>
            <span class="n">a_</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">value</span>
            <span class="n">b_</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">value</span>
            <span class="n">Esplit_</span> <span class="o">=</span> <span class="n">Esplit</span><span class="o">.</span><span class="n">value</span>
            <span class="n">beta_</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">value</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">value</span>

            <span class="n">unit_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_unit</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">alpha_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">,</span> <span class="n">Esplit_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">x_</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">alpha</span><span class="p">,</span>
                <span class="n">Ec</span><span class="p">,</span>
                <span class="n">a</span><span class="p">,</span>
                <span class="n">b</span><span class="p">,</span>
                <span class="n">Esplit</span><span class="p">,</span>
                <span class="n">beta</span><span class="p">,</span>
                <span class="n">x</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">unit_</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="c1"># Cutoff power law</span>

            <span class="n">intflux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ggrb_int_cpl</span><span class="p">(</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Band model</span>

            <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">Esplit</span> <span class="ow">and</span> <span class="n">Esplit</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">:</span>

                <span class="n">intflux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ggrb_int_cpl</span><span class="p">(</span>
                    <span class="n">alpha_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">Esplit_</span>
                <span class="p">)</span> <span class="o">+</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">ggrb_int_pl</span><span class="p">(</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">,</span> <span class="n">Esplit_</span><span class="p">,</span> <span class="n">b_</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">if</span> <span class="n">Esplit</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">:</span>

                    <span class="n">intflux</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">ggrb_int_pl</span><span class="p">(</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">)</span>

                <span class="k">else</span><span class="p">:</span>

                    <span class="n">intflux</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">ggrb_int_cpl</span><span class="p">(</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">,</span> <span class="n">a_</span><span class="p">,</span> <span class="n">b_</span><span class="p">)</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="n">F</span> <span class="o">*</span> <span class="n">erg2keV</span> <span class="o">/</span> <span class="p">(</span><span class="n">intflux</span> <span class="o">*</span> <span class="n">unit_</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">opt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="c1"># Cutoff power law</span>

            <span class="n">flux</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">cplaw_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">,</span> <span class="n">alpha_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">)</span>

            <span class="c1"># flux = norm * np.power(old_div(x, Ec), alpha) * \</span>
            <span class="c1">#     np.exp(old_div(- x, Ec))</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># The norm * 0 is to keep the units right</span>

            <span class="n">flux</span> <span class="o">=</span> <span class="n">nb_func</span><span class="o">.</span><span class="n">band_eval</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">,</span> <span class="n">Ec_</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">flux</span></div></div>


<div class="viewcode-block" id="DoubleSmoothlyBrokenPowerlaw"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.DoubleSmoothlyBrokenPowerlaw">[docs]</a><span class="k">class</span> <span class="nc">DoubleSmoothlyBrokenPowerlaw</span><span class="p">(</span><span class="n">Function1D</span><span class="p">,</span> <span class="n">metaclass</span><span class="o">=</span><span class="n">FunctionMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    description : A smoothly broken power law with two breaks as parameterized in Ravasio, M. E. et al. Astron Astrophys 613, A16 (2018).</span>

<span class="sd">    latex : $\begin{array}{l}\begin{aligned}f(x)=&amp; A x_{\mathrm{b}}^{\alpha_{1}}\left[\left[\left(\frac{x}{x_{\mathrm{b}}}\right)^{-\alpha_{1} n_{1}}+\left(\frac{x}{x_{\mathrm{b}}}\right)^{-\alpha_{2} n_{1}}\right]^{\frac{n_{2}}{n_{1}}}\right.\\&amp;\left.+\left(\frac{x}{x_{\mathrm{j}}}\right)^{-\beta n_{2}} \cdot\left[\left(\frac{x_{\mathrm{j}}}{x_{\mathrm{b}}}\right)^{-\alpha_{1} n_{1}}+\left(\frac{x_{\mathrm{j}}}{x_{\mathrm{b}}}\right)^{-\alpha_{2} n_{1}}\right]^{\frac{n_{2}}{n_{1}}}\right]^{-\frac{1}{n_{2}}}\end{aligned}\\\text { where }\\x_{\mathrm{j}}=x_{\mathrm{p}} \cdot\left(-\frac{\alpha_{2}+2}{\beta+2}\right)^{\frac{1}{\left.\beta-\alpha_{2}\right) n_{2}}}\end{array}$</span>

<span class="sd">    parameters :</span>

<span class="sd">        K :</span>

<span class="sd">            desc : Differential flux at the pivot energy</span>
<span class="sd">            initial value : 1e-4</span>
<span class="sd">            min : 1e-50</span>
<span class="sd">            is_normalization : True</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        alpha1 :</span>

<span class="sd">            desc : photon index below xb</span>
<span class="sd">            initial value : -0.66</span>

<span class="sd">        xb :</span>

<span class="sd">            desc : break energy below xp</span>
<span class="sd">            initial value : 100</span>
<span class="sd">            min : 1e-10</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        n1 :</span>

<span class="sd">            desc : curvature of the first break</span>
<span class="sd">            initial value : 2.0</span>
<span class="sd">            min : 0</span>
<span class="sd">            fix: True</span>

<span class="sd">        alpha2 :</span>

<span class="sd">            desc : photon index between xb and xp</span>
<span class="sd">            initial value : -1.5</span>

<span class="sd">        xp :</span>

<span class="sd">            desc : nuFnu peak</span>
<span class="sd">            initial value : 300</span>
<span class="sd">            min : 1e-10</span>
<span class="sd">            transformation : log10</span>

<span class="sd">        n2 :</span>

<span class="sd">            desc : curvature of the break at xp</span>
<span class="sd">            initial value : 2.0</span>
<span class="sd">            min : 0</span>
<span class="sd">            fix: True</span>

<span class="sd">        beta :</span>

<span class="sd">            desc : photon index above xp</span>
<span class="sd">            initial value : -2.5</span>
<span class="sd">            max : 2</span>


<span class="sd">        piv :</span>

<span class="sd">            desc : pivot energy</span>
<span class="sd">            initial value : 1.</span>
<span class="sd">            fix : yes</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_set_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_unit</span><span class="p">,</span> <span class="n">y_unit</span><span class="p">):</span>
        <span class="c1"># The normalization has the same units as y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">y_unit</span>

        <span class="c1"># The break point has always the same dimension as the x variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xp</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xb</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">piv</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">x_unit</span>

        <span class="c1"># alpha and beta are dimensionless</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha1</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha2</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">dimensionless_unscaled</span>

    <span class="k">def</span> <span class="nf">_fix_units</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">alpha2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">piv</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">astropy_units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">):</span>

            <span class="k">return</span> <span class="p">(</span>
                <span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">K</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">alpha1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">xb</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">n1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">alpha2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">xp</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">n2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">beta</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">piv</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_unit</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">alpha2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<div class="viewcode-block" id="DoubleSmoothlyBrokenPowerlaw.free_curvature"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.DoubleSmoothlyBrokenPowerlaw.free_curvature">[docs]</a>    <span class="k">def</span> <span class="nf">free_curvature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        free the two curvature parameters n1, n2</span>

<span class="sd">        :returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">free</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">free</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="DoubleSmoothlyBrokenPowerlaw.fix_curvature"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.DoubleSmoothlyBrokenPowerlaw.fix_curvature">[docs]</a>    <span class="k">def</span> <span class="nf">fix_curvature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        fix the two curvature parameters n1, n2</span>

<span class="sd">        :returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n1</span><span class="o">.</span><span class="n">fix</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n2</span><span class="o">.</span><span class="n">fix</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="DoubleSmoothlyBrokenPowerlaw.evaluate"><a class="viewcode-back" href="../../../../notebooks/api/astromodels.functions.functions_1D.html#astromodels.functions.DoubleSmoothlyBrokenPowerlaw.evaluate">[docs]</a>    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">alpha2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">piv</span><span class="p">):</span>

        <span class="p">(</span>
            <span class="n">x_</span><span class="p">,</span>
            <span class="n">K_</span><span class="p">,</span>
            <span class="n">alpha1_</span><span class="p">,</span>
            <span class="n">xb_</span><span class="p">,</span>
            <span class="n">n1_</span><span class="p">,</span>
            <span class="n">alpha2_</span><span class="p">,</span>
            <span class="n">xp_</span><span class="p">,</span>
            <span class="n">n2_</span><span class="p">,</span>
            <span class="n">beta_</span><span class="p">,</span>
            <span class="n">piv_</span><span class="p">,</span>
            <span class="n">y_unit</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_units</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">xb</span><span class="p">,</span> <span class="n">n1</span><span class="p">,</span> <span class="n">alpha2</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">n2</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">piv</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">nb_func</span><span class="o">.</span><span class="n">dbl_sbpl</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">K_</span><span class="p">,</span> <span class="n">alpha1_</span><span class="p">,</span> <span class="n">alpha2_</span><span class="p">,</span> <span class="n">beta_</span><span class="p">,</span> <span class="n">xp_</span><span class="p">,</span> <span class="n">xb_</span><span class="p">,</span> <span class="n">n1_</span><span class="p">,</span> <span class="n">n2_</span><span class="p">,</span> <span class="n">piv_</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">y_unit</span>
        <span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016--2022, G.Vianello, J. M. Burgess, N. Di Lalla, N. Omodei, H. Fleischhack.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>